<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Cloudflare WARP 一键配置脚本 使用教程 | Gridea</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://blog.52naiba.cn/favicon.ico?v=1641189121784">
<link rel="stylesheet" href="https://blog.52naiba.cn/styles/main.css">


  

  
    <link rel="stylesheet" href="https://unpkg.com/disqusjs@1.1/dist/disqusjs.css" />
  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="前言
Cloudflare WARP 一键配置脚本是一个简化在 Linux VPS 上安装和配置 Cloud­flare WARP 的脚本，它支持 WARP 官方客户端和 Wire­Guard 两种主流 WARP 使用方式，适用于 IPv4..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://blog.52naiba.cn">
        <img src="https://blog.52naiba.cn/images/avatar.png?v=1641189121784" class="site-logo">
        <h1 class="site-title">Gridea</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      温故而知新
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://blog.52naiba.cn/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Cloudflare WARP 一键配置脚本 使用教程</h2>
            <div class="post-date">2021-12-18</div>
            
            <div class="post-content" v-pre>
              <h2 id="前言">前言</h2>
<p><a href="https://p3terx.com/go/aHR0cHM6Ly9naXRodWIuY29tL1AzVEVSWC93YXJwLnNo">Cloudflare WARP 一键配置脚本</a>是一个简化在 Linux VPS 上安装和配置 Cloud­flare WARP 的脚本，它支持 WARP 官方客户端和 Wire­Guard 两种主流 WARP 使用方式，适用于 IPv4/IPv6 单双栈各类的网络环境，操作系统、 CPU 架构和虚拟化平台支持全面。本篇是介绍说明及简单使用教程。</p>
<p>Cloud­flare WARP 是什么？能干什么？好不好用？以及这个脚本的实现原理知识和其它周边配套设置参见《<a href="https://p3terx.com/archives/use-cloudflare-warp-to-add-extra-ipv4-or-ipv6-network-support-to-vps-servers-for-free.html">Cloudflare WARP 给 VPS 服务器额外添加 IPv4 或 IPv6 网络获得 “原生” IP</a>》。</p>
<h2 id="项目地址">项目地址</h2>
<p>一键安装</p>
<ul>
<li><a href="https://github.com/jinwyp/one_click_script#installation-%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95">Trojan 和 V2ray xray 一键安装脚本</a></li>
<li><a href="https://github.com/jinwyp/one_click_script#installation-linux-kernel-wireguard">安装 最新版和LTS Linux 内核, BBR 和 BBR Plus 内核</a></li>
<li><a href="https://github.com/jinwyp/one_click_script#installation-linux-kernel-wireguard">安装 wireguard 和 Cloudflare WARP, 解锁 Netflix 区域限制 和 避免弹出Google人机验证</a></li>
<li><a href="https://github.com/jinwyp/one_click_script#installation-xrayr">V2board 服务器端 V2Ray-Poseidon, Soga, XrayR, Air-Universe 一键安装脚本</a></li>
<li><a href="https://github.com/jinwyp/one_click_script/blob/master/dsm/readme.md">PVE Proxmox VE虚拟机 群晖NAS 安装工具脚本</a></li>
<li><a href="https://github.com/jinwyp/one_click_script/blob/master/dsm/readme.md">FRP 内网穿透工具 一键安装脚本</a></li>
<li><a href="https://github.com/jinwyp/one_click_script/blob/master/acuteangle/readme.md">锐角云 自动安装PVE 工具脚本</a></li>
</ul>
<p>https://github.com/jinwyp/one_click_script</p>
<p>GitHub</p>
<p>https://github.com/sjlleo/netflix-verify     检查是否解锁Netflix<br>
Github主站下载链接（适用于IPv4网络的机器）：</p>
<p>X86_64：</p>
<p>wget -O nf https://github.com/sjlleo/netflix-verify/releases/download/2.61/nf_2.61_linux_amd64 &amp;&amp; chmod +x nf &amp;&amp; clear &amp;&amp; ./nf<br>
CDN 镜像（适用于 IPv6）：<br>
wget -O nf https://cdn.jsdelivr.net/gh/sjlleo/netflix-verify/CDNRelease/nf_2.61_linux_amd64 &amp;&amp; chmod +x nf &amp;&amp; clear &amp;&amp; ./nf</p>
<p><a href="https://github.com/P3TERX/warp.sh">https://github.com/P3TERX/warp.sh</a></p>
<p>支持本项目欢迎随手点个 <code>star</code>，可以让更多的人发现、使用并受益。你的支持是持续开发维护的动力。</p>
<h2 id="脚本特点">脚本特点</h2>
<ul>
<li>CPU 架构支持：x86(i386)、x86_64(amd64)、ARMv8(aarch64)、ARMv7 等</li>
<li>虚拟化平台支持：KVM、Xen、OpenVZ、LXC 等</li>
<li>操作系统支持：Debian、Ubuntu、CentOS、Arch Linux 以及其它 DEB 系与 RHEL 系下游的最新版本</li>
<li>智能识别网络方案并自动匹配最佳配置方案进行部署</li>
<li>独家优化配置方案，获得更好的 WARP 网络体验</li>
<li>无需更换 Linux 内核，更稳定、更安全、更自由</li>
<li>直观的进程状态、网络状态和 WARP 状态显示</li>
<li>Cloudflare WARP 官方 Linux 客户端支持</li>
<li>“一把梭”式极致体验</li>
</ul>
<figure data-type="image" tabindex="1"><a href="https://imgcdn.p3terx.com/post/20201113013636.jpg#vwid=600&amp;vhei=395"><img src="https://imgcdn.p3terx.com/post/20201113013636.jpg#vwid=600&amp;vhei=395" alt="img" loading="lazy"></a></figure>
<h2 id="使用方法">使用方法</h2>
<p>SSH 连上 VPS 。<s><a href="https://p3terx.com/archives/cheap-and-costeffective-vps-recommended.html">AD: 还没有 VPS ？赶紧点这里去选一个吧！</a></s></p>
<ul>
<li>
<p>无论 VPS 是 IPv4 还是 IPv6 又或都有，添加 WARP Wire­Guard 双栈全局网络，直接使用以下命令一把梭：</p>
<pre><code class="language-bash"># 自动配置 WARP WireGuard 双栈全局网络
bash &lt;(curl -fsSL git.io/warp.sh) d
</code></pre>
</li>
<li>
<p>添加或置换 IPv4/IPv6 网络中的一个为 WARP Wire­Guard 网络，使用以下命令一把梭：</p>
<pre><code class="language-bash"># 自动配置 WARP WireGuard IPv4 网络
bash &lt;(curl -fsSL git.io/warp.sh) 4
# 自动配置 WARP WireGuard IPv6 网络
bash &lt;(curl -fsSL git.io/warp.sh) 6
</code></pre>
</li>
<li>
<p>Cloud­flare 官方于近期发布了 WARP Linux 客户端，同时也带来了全新的 Proxy Mode 功能，它使得我们可以让应用通过本地的 SOCKS5 代理端口去直接使用 WARP 网络。对于想尝鲜官方客户端的小伙伴，可以使用以下命令一把梭自动安装 WARP 官方客户端并开启 SOCKS5 本机代理端口 (<code>127.0.0.1:40000</code>)：</p>
<pre><code class="language-bash"># 自动配置 WARP 官方客户端 SOCKS5 代理
bash &lt;(curl -fsSL git.io/warp.sh) s5
</code></pre>
</li>
<li>
<p>给喜欢功能菜单的小伙伴特别准备的功能，执行以下命令显示功能菜单和贴心的状态显示：</p>
<pre><code class="language-bash"># Cloudflare WARP 一键配置脚本 功能菜单
bash &lt;(curl -fsSL git.io/warp.sh) menu
</code></pre>
<figure data-type="image" tabindex="2"><a href="https://imgcdn.p3terx.com/post/20210718032620.png#vwid=523&amp;vhei=460"><img src="https://imgcdn.p3terx.com/post/20210718032620.png#vwid=523&amp;vhei=460" alt="img" loading="lazy"></a></figure>
</li>
</ul>
<h2 id="注意事项和其它说明">注意事项和其它说明</h2>
<ul>
<li>脚本目前处于公测阶段，可能还存在少量未知的 bug ，虽然不会导致毁灭性的问题，但不建议在生产环境中使用。</li>
<li><code>自动配置 WARP WireGuard 双栈全局网络</code>已做到适配目前大多数主流的系统和 IDC 网络方案，但不排除极个别的差异没考虑到，因此可能会因为路由规则不适用而导致 SSH 失联。若失联可以使用网页 VNC 登录到 VPS 然后执行<code>systemctl disable wg-quick@wgcf --now</code>命令完全禁用 WARP WireGuard 服务即可恢复。</li>
<li>因 WireGuard 的 bug 与 WARP 网络偶发性连接故障，可能会出现网络状态显示均为未连接且网络访问异常的情况，使用<code>systemctl restart wg-quick@wgcf</code>命令重启 WARP WireGuard 进程即可。若一直有问题则一直重启，直到能使用为止。</li>
<li>功能菜单中的<code>选择其它 WARP WireGuard 配置方案</code>最初设计为自动配置时因本地源 IP 识别错误导致失联后的半自动备用方案，目前已经几乎用不到了。如果需要使用可根据实际情况与需求选择，遵循“无则添加、有则置换”原则。注意确认 IP 地址是否需要修改，如需修改可以手动输入 IP。随着脚本的完善，逐步走向智能自动化，后续这个功能菜单可能会移除。</li>
<li>脚本使用 <a href="https://p3terx.com/go/aHR0cHM6Ly9naXRodWIuY29tL1ZpUmIzL3dnY2Y">wgcf</a> 生成通用 WireGuard 配置文件，配置完成后会原样备份至<code>~/.wgcf</code>目录，以便下次脚本自动调用，避免重复申请 WARP 账号导致 IP 被 Cloudflare 拉黑。</li>
<li>若之前自行生成过 WireGuard 配置文件，在文件名为<code>wgcf-profile.conf</code>的情况下在此配置文件所在目录执行脚本会优先调用此配置文件并截取关键信息生成符合所选网络方案的新配置文件。若之前有生成过带有 WARP+ 流量的配置文件，则可以使用这个彩蛋功能。</li>
<li>WARP WireGuard 双栈全局网络可能会导致 Docker 应用在 Bridge 网络模式下无法通过 IP 直接访问。可以使用 Host 网络模式，或者用 nginx 反代的方式去使用。暂时还没有找到完美的解决方案，如果有大佬知道怎么解决，欢迎分享。</li>
<li>WARP 官方 Linux 客户端才上线不久，实测稳定性不佳，且系统支持不全。目前只支持在 x86_64(amd64) 架构的 Debian 10/11、Ubuntu 20.04、CentOS 8 系统中尝鲜使用。其它系统也许能正常安装，但可能存在无法正常启动的问题。</li>
<li>WARP 官方客户端与 WARP WireGuard 网络可以同时使用，但 WARP 客户端的网络数据可能会走在 WARP WireGuard 隧道中，这属于套娃行为，减速效果非常明显。</li>
<li>WARP 官方客户端可能无法在部分 IPv6 Only VPS 上使用，可以先添加 WARP WireGuard IPv4 网络，但正如前面所说套娃减速。</li>
</ul>
<h2 id="遇到问题如何处理">遇到问题如何处理</h2>
<ul>
<li>脚本运行失败或错误请在 <a href="https://p3terx.com/go/aHR0cHM6Ly9naXRodWIuY29tL1AzVEVSWC93YXJwLnNoL2lzc3Vlcw">GitHub issues</a> 页面进行留言，提供虚拟化平台、系统版本、内核版本以及从脚本运行到末尾的详细日志等信息，以便分析问题原因改进脚本。<strong>若未提供有用信息一律当做垃圾信息处理。</strong></li>
<li>重启、重装、重买是解决问题的三大法宝。</li>
</ul>
<h2 id="最后">最后</h2>
<p>这个脚本从方案设计到代码编写全部都是由博主个人原创，且花费了大量时间和精力打磨而成，最初只是自己使用，觉得达到了近乎完美的状态也就开源分享了出来。如果觉得这个脚本对你有帮助，可以去 <a href="https://p3terx.com/go/aHR0cHM6Ly9naXRodWIuY29tL1AzVEVSWC93YXJwLnNo">WARP 脚本的 Github 项目页面</a>点下 Star 点亮小星星支持一下，也欢迎小伙伴们分享出去让更多的人看到、使用并受益。</p>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://blog.52naiba.cn/da-jian-ji-yu-telegraph-de-wu-xian-chu-cun-tu-chuang/">
                  <h3 class="post-title">
                    搭建基于telegraph的无限储存图床
                  </h3>
                </a>
              </div>
            

            
              

              
                <div id="disqus_thread" data-aos="fade-in"></div>
              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>





  

  
    <script src="https://unpkg.com/disqusjs@1.1/dist/disqus.js"></script>
    <script>

    var options = {
      shortname: 'disqus_VB5MsU1LjI',
      apikey: 'dMP3jABp5m3Xm3lr2VvyrqTP1WliooGhnGwIsjChrhYOsxvevWjh89U1SDXCQyzW',
    }
    if ('rWABiEvBGEzrn8Sy5gS4tYNYWxEVz4X6AjTtMMtRbMkAxuZTb32hHSOf3orQFzDz') {
      options.api = 'rWABiEvBGEzrn8Sy5gS4tYNYWxEVz4X6AjTtMMtRbMkAxuZTb32hHSOf3orQFzDz'
    }
    var dsqjs = new DisqusJS(options)

    </script>
  




  </body>
</html>
